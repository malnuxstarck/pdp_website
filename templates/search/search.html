{% extends 'base.html' %}
{% load humanize %}
{% load emarkdown %}

{% block title %}
    Recherche
{% endblock %}

{% block headline %}
    Recherche
{% endblock %}

{% block breadcrumb %}
    <li class="current"><a href="javascript:;">Recherche</a></li>
{% endblock %}

{% block content %}
    <div class="row">
        <form method="get" action=".">
            <table>
                {{ form.as_table }}
                <tr>
                    <td>&nbsp;</td>
                    <td>
                        <button type="submit" class="button">Rechercher</button>
                    </td>
                </tr>
            </table>
            {% if query %}
                {% if page.object_list %}
                    <h3>Resultats</h3>
                        <table>
                          <thead>
                            <tr>
                              <th>Titre</th>
                              <th width="15%">Quand</th>
                              <th width="55%">Extrait</th>
                            </tr>
                          </thead>
                          <tbody>
                            {% for result in page.object_list %}
                                {% if result.content_type == "forum.topic" %}
                                    {% include "search/result_topic.part.html" %}
                                {% elif result.content_type == "tutorial.extract" %}
                                    {% include "search/result_extract.part.html" %}
                                {% else %}
                                    <tr>
                                        <td>(Inconnu)</td>
                                        <td></td>
                                        <td></td>
                                    </tr>
                              {% endif %}
                            {% endfor %}
                          </tbody>
                        </table>
                    {% if page.has_previous or page.has_next %}
                        <div>
                            {% if page.has_previous %}<a href="?q={{ query }}&amp;page={{ page.previous_page_number }}">{% endif %}&laquo; Page précédente{% if page.has_previous %}</a>{% endif %}
                            |
                            {% if page.has_next %}<a href="?q={{ query }}&amp;page={{ page.next_page_number }}">{% endif %}Page suivante &raquo;{% if page.has_next %}</a>{% endif %}
                        </div>
                    {% endif %}
                {% else %}
                    <div class="panel">
                        <p>Aucun résultat trouvé.</p>
                    </div>
                {% endif %}
            {% endif %}
        </form>
    </div>
{% endblock %}
