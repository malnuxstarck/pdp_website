# Build environment
build_environment: ubuntu1204

# Set language to Python
language: python

# Supported Python versions
python:
 - "3.3"

before_install:
 - sudo apt-get update
 - sudo apt-get -y install language-pack-fr
 - rm -Rf south/
 - hg clone https://bitbucket.org/andrewgodwin/south

# Install dependencies
install:
 - pip install -r requirements.txt
 - pip uninstall south -y || return 0
 - pip install ./south/
 - python manage.py syncdb
 - python manage.py migrate

before_script:
 - mkdir -p shippable/codecoverage

# Run tests
script:
 - python manage.py test pdp.article pdp.tutorial pdp.forum pdp.member pdp.utils pdp.pages pdp.messages pdp.gallery
 - which python && coverage run --source="." manage.py test pdp.article pdp.tutorial pdp.forum pdp.member pdp.utils pdp.pages pdp.messages pdp.gallery
 - which python && coverage xml -o shippable/codecoverage/coverage.xml pdp/tutorial/views.py


# Only select master branch to be tested
branches:
 - only:
   - master
